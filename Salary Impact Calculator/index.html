<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>æ´¾é£ç¤¾å“¡ å¹´åãƒ»æ‰‹å–ã‚Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN TOKENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --base-bg:     #e8f5f1;
  --accent:      #a8d5ba;
  --accent-deep: #4a8c6f;
  --text-main:   #44504c;
  --text-sub:    #ccd6d1;
  --card-bg:     #ffffff;
  --mint-light:  #d4ede3;
  --mint-pale:   #f0faf5;
  --shadow:      rgba(74,140,111,0.12);
  --sub-text:    #7a9a8e;
  --placeholder: #b8d4cc;

  --color-nenkin:   #4a7fd4;
  --color-health:   #7aa8e8;
  --color-employ:   #aac8f4;
  --color-income:   #e07a3a;
  --color-resident: #f0c060;
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }

body {
  font-family: 'Hiragino Kaku Gothic ProN', 'ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ ProN W3', 'Hiragino Sans', sans-serif;
  background: var(--base-bg);
  color: var(--text-main);
  min-height: 100vh;
  padding: 20px 16px calc(48px + env(safe-area-inset-bottom));
  -webkit-tap-highlight-color: transparent;
  overflow-x: hidden;
}
@media (min-width: 480px) {
  body { padding: 36px 24px 64px; }
}
@media (min-width: 768px) {
  body { max-width: 680px; margin: 0 auto; padding: 48px 32px 80px; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.app-header {
  text-align: center;
  margin-bottom: 28px;
  animation: fadeInDown 0.7s cubic-bezier(0.22,0.61,0.36,1) both;
}
.app-header h1 {
  font-size: clamp(20px, 5vw, 28px);
  font-weight: 700;
  color: var(--text-main);
  letter-spacing: 0.04em;
  margin-bottom: 8px;
  line-height: 1.35;
}
.app-header p {
  font-size: 13px;
  color: var(--sub-text);
  line-height: 1.75;
  max-width: 420px;
  margin: 0 auto;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BADGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ds-badge {
  display: inline-block;
  background: var(--accent);
  color: #fff;
  font-size: 11px;
  letter-spacing: 0.14em;
  padding: 4px 16px;
  border-radius: 20px;
  font-weight: 500;
  margin-bottom: 14px;
  box-shadow: 0 2px 12px rgba(168,213,186,0.5);
  animation: pulseBadge 3s ease-in-out infinite;
}
@keyframes pulseBadge {
  0%,100% { box-shadow: 0 2px 12px rgba(168,213,186,0.5); }
  50%     { box-shadow: 0 4px 22px rgba(74,140,111,0.45); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card {
  background: var(--card-bg);
  border-radius: 28px;
  padding: 28px 20px;
  box-shadow: 0 8px 40px var(--shadow), 0 1px 4px rgba(0,0,0,0.04), inset 0 1px 0 rgba(255,255,255,0.8);
  margin-bottom: 16px;
  position: relative;
  overflow: hidden;
  animation: fadeInUp 0.7s cubic-bezier(0.22,0.61,0.36,1) both;
}
@media (min-width: 480px) {
  .card { padding: 36px 32px; margin-bottom: 20px; }
}
.card::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 4px;
  background: linear-gradient(90deg, var(--accent), var(--accent-deep), var(--accent));
  background-size: 200%;
  animation: shimmerBar 3s linear infinite;
  border-radius: 28px 28px 0 0;
}
@keyframes shimmerBar {
  0%   { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
@keyframes fadeInDown {
  from { opacity: 0; transform: translateY(-12px); }
  to   { opacity: 1; transform: translateY(0); }
}
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(12px); }
  to   { opacity: 1; transform: translateY(0); }
}

.card-label {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--placeholder);
  margin-bottom: 20px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INPUT ROW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.irow {
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
  padding: 18px 0;
  border-bottom: 1px solid var(--mint-light);
}
@media (min-width: 560px) {
  .irow { grid-template-columns: 180px 1fr; align-items: start; gap: 16px; }
}
.irow:last-child { border-bottom: none; }
.irow-label { display: flex; flex-direction: column; gap: 4px; padding-top: 2px; }
.irow-label .lname {
  font-size: 14px;
  font-weight: 700;
  color: var(--text-main);
  line-height: 1.3;
}
.irow-label .ldesc {
  font-size: 11px;
  color: var(--sub-text);
  line-height: 1.5;
}
.irow-right { display: flex; flex-direction: column; gap: 12px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NUMBER INPUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.val-row { display: flex; align-items: center; gap: 8px; }
.num-edit {
  font-size: clamp(15px, 4vw, 17px);
  font-weight: 300;
  font-family: 'Roboto', sans-serif;
  color: var(--text-main);
  border: 2px solid var(--mint-light);
  border-radius: 12px;
  background: var(--mint-pale);
  outline: none;
  width: 88px;
  padding: 7px 10px;
  -moz-appearance: textfield;
  transition: all 0.3s ease;
  letter-spacing: 0.03em;
}
.num-edit:focus {
  border-color: var(--accent);
  background: var(--card-bg);
  box-shadow: 0 0 0 4px rgba(168,213,186,0.25);
}
.num-edit::-webkit-outer-spin-button,
.num-edit::-webkit-inner-spin-button { -webkit-appearance: none; }
.num-edit.narrow   { width: 72px; }
.num-edit.narrower { width: 58px; }
.val-unit {
  font-size: 12px;
  color: var(--sub-text);
  font-weight: 400;
  flex-shrink: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SELECT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.select-input {
  font-size: clamp(14px, 3.5vw, 16px);
  font-weight: 300;
  font-family: 'Roboto', sans-serif;
  color: var(--text-main);
  border: 2px solid var(--mint-light);
  border-radius: 12px;
  background: var(--mint-pale);
  outline: none;
  cursor: pointer;
  padding: 7px 10px;
  -webkit-appearance: none;
  appearance: none;
  transition: all 0.3s ease;
}
.select-input:focus {
  border-color: var(--accent);
  background: var(--card-bg);
  box-shadow: 0 0 0 4px rgba(168,213,186,0.25);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUICK BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.quick-btn-group {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}
.quick-btn {
  background: transparent;
  color: var(--sub-text);
  border: 1.5px solid var(--mint-light);
  border-radius: 20px;
  padding: 6px 12px;
  min-height: 30px;
  font-size: 11px;
  font-family: inherit;
  font-weight: 500;
  letter-spacing: 0.04em;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.34,1.56,0.64,1);
  white-space: nowrap;
  -webkit-tap-highlight-color: transparent;
}
.quick-btn:hover {
  border-color: var(--accent-deep);
  color: var(--accent-deep);
  background: var(--mint-pale);
  transform: scale(1.04);
}
.quick-btn:active { transform: scale(0.96); }
.quick-btn.active {
  background: var(--accent-deep);
  border-color: var(--accent-deep);
  color: #fff;
  box-shadow: 0 2px 12px rgba(74,140,111,0.35);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEGMENT CONTROLï¼ˆæœŸé–“åˆ‡ã‚Šæ›¿ãˆï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ds-segment {
  display: flex;
  gap: 6px;
  background: var(--mint-pale);
  padding: 5px;
  border-radius: 14px;
  width: fit-content;
  margin-bottom: 24px;
}
.ds-seg-btn {
  padding: 9px 24px;
  border: none;
  border-radius: 10px;
  font-size: 13px;
  font-weight: 500;
  font-family: inherit;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
  color: var(--sub-text);
  background: transparent;
  letter-spacing: 0.04em;
  -webkit-tap-highlight-color: transparent;
}
.ds-seg-btn.active {
  background: var(--card-bg);
  color: var(--accent-deep);
  box-shadow: 0 2px 10px var(--shadow);
  transform: scale(1.02);
}
.ds-seg-btn:hover:not(.active) { background: rgba(168,213,186,0.2); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESULT CARDSï¼ˆã‚µãƒãƒªãƒ¼ï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.summary {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 24px;
}
@media (min-width: 480px) { .summary { grid-template-columns: repeat(3, 1fr); } }

.ds-result {
  background: var(--mint-pale);
  border-radius: 16px;
  padding: 16px 14px;
  border: 1.5px solid var(--mint-light);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  text-align: center;
}
.ds-result:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px var(--shadow);
}
.ds-result.highlight {
  background: linear-gradient(135deg, #f0faf6, #e8f5f1);
  border-color: var(--accent);
  box-shadow: 0 4px 20px rgba(74,140,111,0.1);
}
.ds-result-label {
  font-size: 11px;
  color: var(--sub-text);
  margin-bottom: 8px;
  letter-spacing: 0.06em;
  line-height: 1.4;
}
.ds-result-value {
  font-family: 'Roboto', sans-serif;
  font-size: clamp(22px, 6vw, 28px);
  font-weight: 300;
  color: var(--text-main);
  line-height: 1;
  display: flex;
  align-items: baseline;
  justify-content: center;
  gap: 3px;
}
.ds-result-value.em { color: var(--accent-deep); font-weight: 400; }
.ds-result-unit {
  font-family: inherit;
  font-size: 12px;
  color: var(--sub-text);
  font-weight: 400;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DEDUCTION BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.bar-section { margin-bottom: 24px; }
.bar-title {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--placeholder);
  margin-bottom: 12px;
}
.stacked-bar {
  height: 10px;
  border-radius: 5px;
  overflow: hidden;
  display: flex;
  width: 100%;
  margin-bottom: 20px;
  background: var(--mint-light);
}
.bar-seg {
  height: 100%;
  transition: width 0.6s cubic-bezier(0.22,0.61,0.36,1);
}
.bar-seg-takehome { background: linear-gradient(90deg, var(--accent), var(--accent-deep)); }
.bar-seg-nenkin   { background: var(--color-nenkin); }
.bar-seg-health   { background: var(--color-health); }
.bar-seg-employ   { background: var(--color-employ); }
.bar-seg-income   { background: var(--color-income); }
.bar-seg-resident { background: var(--color-resident); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LEGEND
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.legend-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px 20px;
}
@media (min-width: 560px) { .legend-grid { grid-template-columns: repeat(3, 1fr); } }
.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
}
.legend-dot {
  width: 10px;
  height: 10px;
  border-radius: 3px;
  flex-shrink: 0;
}
.legend-label { color: var(--sub-text); flex: 1; }
.legend-amount { font-family: 'Roboto', sans-serif; font-weight: 500; color: var(--text-main); white-space: nowrap; font-size: 11px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DETAIL TABLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.info-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}
.info-table th {
  text-align: left;
  padding: 8px 14px;
  font-size: 10px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--placeholder);
  border-bottom: 1px solid var(--mint-light);
  font-weight: 600;
}
.info-table td {
  padding: 12px 14px;
  border-bottom: 1px solid var(--mint-light);
  color: var(--text-main);
  vertical-align: middle;
}
.info-table tr:hover td { background: var(--mint-pale); }
.info-table tr:last-child td { border-bottom: none; }
.info-table .td-right { text-align: right; }
.info-table .td-num {
  text-align: right;
  font-family: 'Roboto', sans-serif;
  font-weight: 300;
  color: var(--text-main);
  font-size: 14px;
}
.info-table .td-muted { text-align: right; font-size: 11px; color: var(--sub-text); }
.info-table .tr-total td { background: var(--mint-pale); font-weight: 700; }
.info-table .tr-takehome td {
  background: linear-gradient(135deg, #f0faf6, #e8f5f1);
  font-weight: 700;
  color: var(--accent-deep);
  font-size: 14px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DIVIDER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ds-divider {
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--mint-light), transparent);
  margin: 20px 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NOTE BOXï¼ˆæ³¨é‡ˆãƒ»å…è²¬ï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.note-box {
  background: rgba(168,213,186,0.1);
  border-left: 3px solid var(--accent);
  border-radius: 12px;
  padding: 14px 18px;
  font-size: 11px;
  color: var(--sub-text);
  line-height: 1.9;
  letter-spacing: 0.04em;
  margin-top: 16px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card:nth-child(2) { animation-delay: 0.05s; }
.card:nth-child(3) { animation-delay: 0.10s; }
.card:nth-child(4) { animation-delay: 0.15s; }

/* Scrollbar */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--mint-light); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--accent); }
</style>
</head>
<body>

<!-- ===== HEADER ===== -->
<div class="app-header">
  <div class="ds-badge">ğŸ’¼ Simulator</div>
  <h1>æ´¾é£ç¤¾å“¡ å¹´åãƒ»æ‰‹å–ã‚Š<br>ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
  <p>æ¡ä»¶ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã ã‘ã§ã€æœˆåãƒ»å¹´åãƒ»æ‰‹å–ã‚Šã¨å„ç¨®æ§é™¤é¡ã‚’è‡ªå‹•è¨ˆç®—ã—ã¾ã™ã€‚</p>
</div>

<!-- ===== INPUT CARD ===== -->
<div class="card">
  <div class="card-label">ğŸ“ åŸºæœ¬æ¡ä»¶ã‚’å…¥åŠ›</div>

  <!-- æ™‚çµ¦ -->
  <div class="irow">
    <div class="irow-label">
      <span class="lname">æ™‚çµ¦</span>
      <span class="ldesc">ãƒœã‚¿ãƒ³ã§é¸æŠã€ã¾ãŸã¯ç›´æ¥å…¥åŠ›</span>
    </div>
    <div class="irow-right">
      <div class="val-row">
        <input class="num-edit" type="number" id="hourlyWageInput" value="1500" min="900" max="9999" step="1"
          oninput="onDirectInput(event,'hourlyWage','qbHourlyWage')">
        <span class="val-unit">å†† / æ™‚</span>
      </div>
      <div class="quick-btn-group" id="qbHourlyWage">
        <button class="quick-btn" data-val="1400" onclick="setVal('hourlyWage',1400,'qbHourlyWage',this)">1,400å††</button>
        <button class="quick-btn active" data-val="1500" onclick="setVal('hourlyWage',1500,'qbHourlyWage',this)">1,500å††</button>
        <button class="quick-btn" data-val="1600" onclick="setVal('hourlyWage',1600,'qbHourlyWage',this)">1,600å††</button>
        <button class="quick-btn" data-val="1700" onclick="setVal('hourlyWage',1700,'qbHourlyWage',this)">1,700å††</button>
        <button class="quick-btn" data-val="1800" onclick="setVal('hourlyWage',1800,'qbHourlyWage',this)">1,800å††</button>
        <button class="quick-btn" data-val="1900" onclick="setVal('hourlyWage',1900,'qbHourlyWage',this)">1,900å††</button>
        <button class="quick-btn" data-val="2000" onclick="setVal('hourlyWage',2000,'qbHourlyWage',this)">2,000å††</button>
      </div>
    </div>
  </div>

  <!-- 1æ—¥ã®åŠ´åƒæ™‚é–“ -->
  <div class="irow">
    <div class="irow-label">
      <span class="lname">1æ—¥ã®åŠ´åƒæ™‚é–“</span>
      <span class="ldesc">ä¼‘æ†©é™¤ãå®ŸåŠ´åƒæ™‚é–“</span>
    </div>
    <div class="irow-right">
      <div class="val-row">
        <input class="num-edit narrow" type="number" id="hoursPerDayInput" value="8" min="1" max="24" step="0.5"
          oninput="onDirectInput(event,'hoursPerDay','qbHoursPerDay')">
        <span class="val-unit">æ™‚é–“ / æ—¥</span>
      </div>
      <div class="quick-btn-group" id="qbHoursPerDay">
        <button class="quick-btn active" data-val="8"   onclick="setVal('hoursPerDay',8,'qbHoursPerDay',this)">8æ™‚é–“</button>
        <button class="quick-btn" data-val="7.5" onclick="setVal('hoursPerDay',7.5,'qbHoursPerDay',this)">7.5æ™‚é–“</button>
        <button class="quick-btn" data-val="7"   onclick="setVal('hoursPerDay',7,'qbHoursPerDay',this)">7æ™‚é–“</button>
      </div>
    </div>
  </div>

  <!-- æœˆã®å‹¤å‹™æ—¥æ•° -->
  <div class="irow">
    <div class="irow-label">
      <span class="lname">æœˆã®å‹¤å‹™æ—¥æ•°</span>
      <span class="ldesc">é€±ã‚ãŸã‚Šã®æ—¥æ•°Ã—4ã§è¨ˆç®—ã€ã¾ãŸã¯ç›´æ¥å…¥åŠ›</span>
    </div>
    <div class="irow-right">
      <div class="val-row">
        <input class="num-edit narrow" type="number" id="daysPerMonthInput" value="20" min="1" max="31" step="1"
          oninput="onDirectInput(event,'daysPerMonth','qbDaysPerMonth')">
        <span class="val-unit">æ—¥ / æœˆ</span>
      </div>
      <div class="quick-btn-group" id="qbDaysPerMonth">
        <button class="quick-btn active" data-val="20" onclick="setVal('daysPerMonth',20,'qbDaysPerMonth',this)">é€±5æ—¥ï¼ˆ20æ—¥ï¼‰</button>
        <button class="quick-btn" data-val="16" onclick="setVal('daysPerMonth',16,'qbDaysPerMonth',this)">é€±4æ—¥ï¼ˆ16æ—¥ï¼‰</button>
        <button class="quick-btn" data-val="12" onclick="setVal('daysPerMonth',12,'qbDaysPerMonth',this)">é€±3æ—¥ï¼ˆ12æ—¥ï¼‰</button>
      </div>
    </div>
  </div>

  <!-- å±…ä½åœ° -->
  <div class="irow">
    <div class="irow-label">
      <span class="lname">å±…ä½åœ°</span>
      <span class="ldesc">ä½æ°‘ç¨ç‡ã«å½±éŸ¿</span>
    </div>
    <div class="irow-right">
      <select class="select-input" id="prefecture" onchange="calculate()">
        <option value="tokyo">æ±äº¬éƒ½</option>
        <option value="osaka">å¤§é˜ªåºœ</option>
        <option value="aichi">æ„›çŸ¥çœŒ</option>
        <option value="other">ãã®ä»–</option>
      </select>
    </div>
  </div>

  <!-- æ‰¶é¤Šå®¶æ— -->
  <div class="irow">
    <div class="irow-label">
      <span class="lname">æ‰¶é¤Šå®¶æ—æ•°</span>
      <span class="ldesc">é…å¶è€…ãƒ»å­ãªã©ï¼ˆæ‰€å¾—æ§é™¤ã«å½±éŸ¿ï¼‰</span>
    </div>
    <div class="irow-right">
      <div class="val-row">
        <input class="num-edit narrower" type="number" id="dependentsInput" value="0" min="0" max="10" step="1"
          oninput="onDirectInput(event,'dependents','qbDependents')">
        <span class="val-unit">äºº</span>
      </div>
      <div class="quick-btn-group" id="qbDependents">
        <button class="quick-btn active" data-val="0" onclick="setVal('dependents',0,'qbDependents',this)">0äºº</button>
        <button class="quick-btn" data-val="1" onclick="setVal('dependents',1,'qbDependents',this)">1äºº</button>
        <button class="quick-btn" data-val="2" onclick="setVal('dependents',2,'qbDependents',this)">2äºº</button>
        <button class="quick-btn" data-val="3" onclick="setVal('dependents',3,'qbDependents',this)">3äºº</button>
      </div>
    </div>
  </div>
</div>

<!-- ===== RESULT CARD ===== -->
<div class="card">
  <div class="card-label">ğŸ’° è¨ˆç®—çµæœ</div>

  <div class="ds-segment">
    <button class="ds-seg-btn active" id="btnMonthly" onclick="setPeriod('monthly')">æœˆé¡</button>
    <button class="ds-seg-btn" id="btnYearly" onclick="setPeriod('yearly')">å¹´é–“</button>
  </div>

  <div class="summary">
    <div class="ds-result">
      <div class="ds-result-label">ç·æ”¯çµ¦é¡</div>
      <div class="ds-result-value">
        <span id="grossAmount">â€”</span>
        <span class="ds-result-unit" id="grossUnit">â€”</span>
      </div>
    </div>
    <div class="ds-result">
      <div class="ds-result-label">æ§é™¤åˆè¨ˆ</div>
      <div class="ds-result-value">
        <span id="totalDeduction">â€”</span>
        <span class="ds-result-unit" id="deductUnit">â€”</span>
      </div>
    </div>
    <div class="ds-result highlight">
      <div class="ds-result-label">æ‰‹å–ã‚Š</div>
      <div class="ds-result-value em">
        <span id="takeHome">â€”</span>
        <span class="ds-result-unit" id="takeHomeUnit">â€”</span>
      </div>
    </div>
  </div>

  <!-- æ§‹æˆãƒãƒ¼ -->
  <div class="bar-section">
    <div class="bar-title">åå…¥ã®å†…è¨³</div>
    <div class="stacked-bar" id="stackedBar">
      <div class="bar-seg bar-seg-takehome" id="barTakeHome" style="width:70%"></div>
      <div class="bar-seg bar-seg-nenkin"   id="barNenkin"   style="width:9%"></div>
      <div class="bar-seg bar-seg-health"   id="barHealth"   style="width:5%"></div>
      <div class="bar-seg bar-seg-employ"   id="barEmploy"   style="width:1%"></div>
      <div class="bar-seg bar-seg-income"   id="barIncome"   style="width:8%"></div>
      <div class="bar-seg bar-seg-resident" id="barResident" style="width:7%"></div>
    </div>
    <div class="legend-grid">
      <div class="legend-item">
        <div class="legend-dot" style="background:var(--accent-deep)"></div>
        <span class="legend-label">æ‰‹å–ã‚Š</span>
        <span class="legend-amount" id="lgTakeHome">â€”</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:var(--color-nenkin)"></div>
        <span class="legend-label">åšç”Ÿå¹´é‡‘</span>
        <span class="legend-amount" id="lgNenkin">â€”</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:var(--color-health)"></div>
        <span class="legend-label">å¥åº·ä¿é™º</span>
        <span class="legend-amount" id="lgHealth">â€”</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:var(--color-employ)"></div>
        <span class="legend-label">é›‡ç”¨ä¿é™º</span>
        <span class="legend-amount" id="lgEmploy">â€”</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:var(--color-income)"></div>
        <span class="legend-label">æ‰€å¾—ç¨</span>
        <span class="legend-amount" id="lgIncome">â€”</span>
      </div>
      <div class="legend-item">
        <div class="legend-dot" style="background:var(--color-resident)"></div>
        <span class="legend-label">ä½æ°‘ç¨</span>
        <span class="legend-amount" id="lgResident">â€”</span>
      </div>
    </div>
  </div>
</div>

<!-- ===== DETAIL CARD ===== -->
<div class="card">
  <div class="card-label">ğŸ“Š æ§é™¤ã®è©³ç´°å†…è¨³</div>
  <table class="info-table">
    <thead>
      <tr>
        <th>é …ç›®</th>
        <th class="td-right">ç‡</th>
        <th class="td-right">æœˆé¡</th>
        <th class="td-right">å¹´é–“</th>
      </tr>
    </thead>
    <tbody id="deductTableBody"></tbody>
  </table>

  <div class="note-box">
    <p>ğŸ“‹ ç¤¾ä¼šä¿é™ºæ–™ï¼ˆåšç”Ÿå¹´é‡‘ãƒ»å¥åº·ä¿é™ºï¼‰ã¯æ¨™æº–å ±é…¬æœˆé¡ã«åŸºã¥ãæ¦‚ç®—ã€‚å®Ÿéš›ã®é¡ã¯ä¿é™ºè€…ãƒ»åŠ å…¥çµ„åˆã«ã‚ˆã‚Šç•°ãªã‚Šã¾ã™ã€‚</p>
    <p>æ‰€å¾—ç¨ã¯çµ¦ä¸æ‰€å¾—æ§é™¤å¾Œã®èª²ç¨æ‰€å¾—ã«åŸºã¥ãæ¦‚ç®—ï¼ˆå¾©èˆˆç‰¹åˆ¥æ‰€å¾—ç¨2.1%å«ã‚€ï¼‰ã€‚å¹´æœ«èª¿æ•´ã§ç¢ºå®šã—ã¾ã™ã€‚</p>
    <p>ä½æ°‘ç¨ã¯å‰å¹´æ‰€å¾—èª²ç¨ã®ãŸã‚ã€åˆå¹´åº¦ã¯ç™ºç”Ÿã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚å‡ç­‰å‰² 5,000å††/å¹´ å«ã‚€ã€‚</p>
    <p>é€±20æ™‚é–“æœªæº€ã®å ´åˆã¯ç¤¾ä¼šä¿é™ºï¼ˆå¥ä¿ãƒ»å¹´é‡‘ï¼‰ã®å¯¾è±¡å¤–ã¨ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>
    <p>æœ¬è¨ˆç®—ã¯ã‚ãã¾ã§æ¦‚ç®—ã§ã™ã€‚æ­£ç¢ºãªé‡‘é¡ã¯å‹¤å‹™å…ˆãƒ»ç¨ç†å£«ã«ã”ç¢ºèªãã ã•ã„ã€‚</p>
  </div>
</div>

<script>
// ===== STATE =====
let period = 'monthly';
const state = {
  hourlyWage:   1500,
  hoursPerDay:  8,
  daysPerMonth: 20,
  dependents:   0,
};

// ===== HELPERS =====
function fmtParts(n) {
  if (n >= 10000) return { num: (n / 10000).toFixed(1).replace(/\.0$/, ''), unit: 'ä¸‡å††' };
  return { num: n.toLocaleString(), unit: 'å††' };
}
function fmtFull(n) { return n.toLocaleString(); }

function syncBtnGroup(groupId, val) {
  document.querySelectorAll('#' + groupId + ' .quick-btn').forEach(btn => {
    btn.classList.toggle('active', parseFloat(btn.dataset.val) === val);
  });
}
function setVal(key, val, groupId, btn) {
  state[key] = val;
  const inputEl = document.getElementById(key + 'Input');
  if (inputEl) inputEl.value = val;
  syncBtnGroup(groupId, val);
  calculate();
}
function onDirectInput(e, key, groupId) {
  const val = parseFloat(e.target.value);
  if (isNaN(val)) return;
  state[key] = val;
  syncBtnGroup(groupId, val);
  calculate();
}

// ===== TAX CALCULATION =====
function calcSocialInsurance(monthlyGross) {
  const nenkin = Math.round(monthlyGross * 0.0915);
  const health = Math.round(monthlyGross * 0.05);
  const employ = Math.round(monthlyGross * 0.006);
  return { nenkin, health, employ };
}
function calcIncomeTax(yearlyTaxableIncome) {
  const brackets = [
    { limit: 1_950_000,  rate: 0.05,  deduct: 0 },
    { limit: 3_300_000,  rate: 0.10,  deduct: 97_500 },
    { limit: 6_950_000,  rate: 0.20,  deduct: 427_500 },
    { limit: 9_000_000,  rate: 0.23,  deduct: 636_000 },
    { limit: 18_000_000, rate: 0.33,  deduct: 1_536_000 },
    { limit: 40_000_000, rate: 0.40,  deduct: 2_796_000 },
    { limit: Infinity,   rate: 0.45,  deduct: 4_796_000 },
  ];
  if (yearlyTaxableIncome <= 0) return 0;
  for (const b of brackets) {
    if (yearlyTaxableIncome <= b.limit) {
      return Math.max(0, Math.round((yearlyTaxableIncome * b.rate - b.deduct) * 1.021));
    }
  }
  return 0;
}
function calcResidentTax(yearlyTaxableIncome) {
  if (yearlyTaxableIncome <= 0) return 5000;
  return Math.round(yearlyTaxableIncome * 0.10) + 5000;
}
function getEmploymentIncomeDeduction(yearlyGross) {
  if (yearlyGross <= 1_625_000) return 550_000;
  if (yearlyGross <= 1_800_000) return Math.round(yearlyGross * 0.4 - 100_000);
  if (yearlyGross <= 3_600_000) return Math.round(yearlyGross * 0.3 + 80_000);
  if (yearlyGross <= 6_600_000) return Math.round(yearlyGross * 0.2 + 440_000);
  if (yearlyGross <= 8_500_000) return Math.round(yearlyGross * 0.1 + 1_100_000);
  return 1_950_000;
}

// ===== ANIMATE NUMBER =====
function animateNum(numEl, unitEl, from, to) {
  const t0 = performance.now();
  function step(now) {
    const p = Math.min((now - t0) / 600, 1);
    const ease = 1 - Math.pow(1 - p, 4);
    const v = Math.round(from + (to - from) * ease);
    const parts = fmtParts(v);
    numEl.textContent = parts.num;
    if (unitEl) unitEl.textContent = parts.unit;
    if (p < 1) requestAnimationFrame(step);
    else {
      const final = fmtParts(to);
      numEl.textContent = final.num;
      if (unitEl) unitEl.textContent = final.unit;
    }
  }
  requestAnimationFrame(step);
}

// ===== MAIN CALCULATE =====
const prevVals = { g: 0, d: 0, th: 0 };

function calculate() {
  const { hourlyWage, hoursPerDay, daysPerMonth, dependents } = state;

  const monthlyGross = Math.round(hourlyWage * hoursPerDay * daysPerMonth);
  const yearlyGross  = monthlyGross * 12;

  const { nenkin, health, employ } = calcSocialInsurance(monthlyGross);
  const yearlyNenkin = nenkin * 12;
  const yearlyHealth = health * 12;
  const yearlyEmploy = employ * 12;
  const yearlySocial = yearlyNenkin + yearlyHealth + yearlyEmploy;

  const employDeduction    = getEmploymentIncomeDeduction(yearlyGross);
  const basicDeduction     = 480_000;
  const dependentDeduction = dependents * 380_000;
  const taxableBase        = yearlyGross - employDeduction - yearlySocial;
  const taxableIncome      = Math.max(0, taxableBase - basicDeduction - dependentDeduction);

  const yearlyIncomeTax   = calcIncomeTax(taxableIncome);
  const yearlyResidentTax = calcResidentTax(taxableIncome);
  const monthlyIncomeTax   = Math.round(yearlyIncomeTax / 12);
  const monthlyResidentTax = Math.round(yearlyResidentTax / 12);

  const monthlyDeduction = nenkin + health + employ + monthlyIncomeTax + monthlyResidentTax;
  const yearlyDeduction  = yearlySocial + yearlyIncomeTax + yearlyResidentTax;
  const monthlyTakeHome  = monthlyGross - monthlyDeduction;
  const yearlyTakeHome   = yearlyGross - yearlyDeduction;

  const g  = period === 'yearly' ? yearlyGross     : monthlyGross;
  const d  = period === 'yearly' ? yearlyDeduction : monthlyDeduction;
  const th = period === 'yearly' ? yearlyTakeHome  : monthlyTakeHome;

  animateNum(document.getElementById('grossAmount'),    document.getElementById('grossUnit'),     prevVals.g,  g);
  animateNum(document.getElementById('totalDeduction'), document.getElementById('deductUnit'),    prevVals.d,  d);
  animateNum(document.getElementById('takeHome'),       document.getElementById('takeHomeUnit'),  prevVals.th, th);
  prevVals.g = g; prevVals.d = d; prevVals.th = th;

  // ãƒãƒ¼
  const total = monthlyGross;
  const pTH = total > 0 ? (monthlyTakeHome   / total * 100).toFixed(1) : 0;
  const pN  = total > 0 ? (nenkin             / total * 100).toFixed(1) : 0;
  const pH  = total > 0 ? (health             / total * 100).toFixed(1) : 0;
  const pE  = total > 0 ? (employ             / total * 100).toFixed(1) : 0;
  const pI  = total > 0 ? (monthlyIncomeTax   / total * 100).toFixed(1) : 0;
  const pR  = total > 0 ? (monthlyResidentTax / total * 100).toFixed(1) : 0;
  document.getElementById('barTakeHome').style.width = pTH + '%';
  document.getElementById('barNenkin').style.width   = pN  + '%';
  document.getElementById('barHealth').style.width   = pH  + '%';
  document.getElementById('barEmploy').style.width   = pE  + '%';
  document.getElementById('barIncome').style.width   = pI  + '%';
  document.getElementById('barResident').style.width = pR  + '%';

  // ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰
  const lm = period === 'yearly' ? 12 : 1;
  document.getElementById('lgTakeHome').textContent = fmtFull(monthlyTakeHome * lm) + 'å††';
  document.getElementById('lgNenkin').textContent   = fmtFull(nenkin * lm) + 'å††';
  document.getElementById('lgHealth').textContent   = fmtFull(health * lm) + 'å††';
  document.getElementById('lgEmploy').textContent   = fmtFull(employ * lm) + 'å††';
  document.getElementById('lgIncome').textContent   = fmtFull(monthlyIncomeTax * lm) + 'å††';
  document.getElementById('lgResident').textContent = fmtFull(monthlyResidentTax * lm) + 'å††';

  // è©³ç´°ãƒ†ãƒ¼ãƒ–ãƒ«
  const rows = [
    { name: 'åšç”Ÿå¹´é‡‘ä¿é™ºæ–™', color: 'var(--color-nenkin)',   desc: 'åŠ´åƒè€…è² æ‹… 9.15%',   rate: '9.15%', monthly: nenkin,             yearly: yearlyNenkin },
    { name: 'å¥åº·ä¿é™ºæ–™',     color: 'var(--color-health)',   desc: 'å”ä¼šã‘ã‚“ã½æ¦‚ç®— 5%',  rate: '5.00%', monthly: health,             yearly: yearlyHealth },
    { name: 'é›‡ç”¨ä¿é™ºæ–™',     color: 'var(--color-employ)',   desc: 'åŠ´åƒè€…è² æ‹… 0.6%',    rate: '0.60%', monthly: employ,             yearly: yearlyEmploy },
    { name: 'æ‰€å¾—ç¨',         color: 'var(--color-income)',   desc: 'å¾©èˆˆç‰¹åˆ¥ç¨å«ã‚€æ¦‚ç®—',  rate: 'â€”',    monthly: monthlyIncomeTax,   yearly: yearlyIncomeTax },
    { name: 'ä½æ°‘ç¨',         color: 'var(--color-resident)', desc: 'å‡ç­‰å‰²5,000å††å«ã‚€',   rate: '10%',  monthly: monthlyResidentTax, yearly: yearlyResidentTax },
  ];

  const tbody = document.getElementById('deductTableBody');
  tbody.innerHTML = rows.map(r => `
    <tr>
      <td>
        <div style="display:flex;align-items:center;gap:10px">
          <span style="width:10px;height:10px;border-radius:3px;background:${r.color};flex-shrink:0;display:inline-block"></span>
          <div>
            <div style="font-weight:700;font-size:13px">${r.name}</div>
            <div style="font-size:10px;color:var(--sub-text);margin-top:1px">${r.desc}</div>
          </div>
        </div>
      </td>
      <td class="td-muted">${r.rate}</td>
      <td class="td-num">${fmtFull(r.monthly)}<span style="font-size:11px;color:var(--sub-text);margin-left:2px">å††</span></td>
      <td class="td-num">${fmtFull(r.yearly)}<span style="font-size:11px;color:var(--sub-text);margin-left:2px">å††</span></td>
    </tr>
  `).join('') + `
    <tr class="tr-total">
      <td colspan="2"><strong>æ§é™¤åˆè¨ˆ</strong></td>
      <td class="td-num">${fmtFull(monthlyDeduction)}<span style="font-size:11px;color:var(--sub-text);margin-left:2px">å††</span></td>
      <td class="td-num">${fmtFull(yearlyDeduction)}<span style="font-size:11px;color:var(--sub-text);margin-left:2px">å††</span></td>
    </tr>
    <tr class="tr-takehome">
      <td colspan="2"><strong>âœ… æ‰‹å–ã‚Š</strong></td>
      <td class="td-num">${fmtFull(monthlyTakeHome)}<span style="font-size:11px;margin-left:2px">å††</span></td>
      <td class="td-num">${fmtFull(yearlyTakeHome)}<span style="font-size:11px;margin-left:2px">å††</span></td>
    </tr>
  `;
}

function setPeriod(p) {
  period = p;
  document.getElementById('btnMonthly').classList.toggle('active', p === 'monthly');
  document.getElementById('btnYearly').classList.toggle('active', p === 'yearly');
  prevVals.g = 0; prevVals.d = 0; prevVals.th = 0;
  calculate();
}

document.addEventListener('DOMContentLoaded', () => { calculate(); });
</script>
</body>
</html>
